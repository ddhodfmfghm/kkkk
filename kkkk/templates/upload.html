<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</h1>
        </header>

        <nav>
            <a href="{{ url_for('index') }}">–ì–ª–∞–≤–Ω–∞—è</a>
            <a href="{{ url_for('upload_file') }}" class="active">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
            <a href="{{ url_for('history') }}">–ò—Å—Ç–æ—Ä–∏—è</a>
        </nav>

        <main>
            <div class="upload-section">
                <form method="POST" enctype="multipart/form-data" class="upload-form">
                    <div class="form-group">
                        <label for="file">–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
                        <input type="file" id="file" name="file" accept="image/*" required>
                    </div>

                    <div class="form-group">
                        <label for="format">–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞:</label>
                        <select id="format" name="format">
                            <option value="jpeg">JPEG</option>
                            <option value="png">PNG</option>
                            <option value="gif">GIF</option>
                            <option value="bmp">BMP</option>
                            <option value="webp">WEBP</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="quality">–ö–∞—á–µ—Å—Ç–≤–æ (1-100):</label>
                        <input type="range" id="quality" name="quality" min="1" max="100" value="85">
                        <span id="quality-value">85%</span>
                    </div>

                    <div class="form-group">
                        <label>–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):</label>
                        <div class="resize-inputs">
                            <input type="number" name="resize_width" placeholder="–®–∏—Ä–∏–Ω–∞ (px)">
                            <span>√ó</span>
                            <input type="number" name="resize_height" placeholder="–í—ã—Å–æ—Ç–∞ (px)">
                        </div>
                    </div>

                    <button type="submit" class="btn-primary">–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>
            </div>

            {% if original and converted %}
            <div class="result-section">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏</h2>

                <div class="image-comparison">
                    <div class="image-box">
                        <h3>–û—Ä–∏–≥–∏–Ω–∞–ª</h3>
                        <img src="{{ url_for('static', filename=original) }}" alt="–û—Ä–∏–≥–∏–Ω–∞–ª">
                        <p>–§–æ—Ä–º–∞—Ç: {{ conversion.original_format|upper }}</p>
                        <p>–†–∞–∑–º–µ—Ä: {{ (conversion.original_size / 1024)|round(2) }} KB</p>
                    </div>

                    <div class="image-box">
                        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
                        <img src="{{ url_for('static', filename=converted) }}" alt="–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ">
                        <p>–§–æ—Ä–º–∞—Ç: {{ conversion.converted_format|upper }}</p>
                        <p>–†–∞–∑–º–µ—Ä: {{ (conversion.converted_size / 1024)|round(2) }} KB</p>
                        <p>–ö–∞—á–µ—Å—Ç–≤–æ: {{ conversion.quality }}%</p>
                        <p>–°–∂–∞—Ç–∏–µ: {{ conversion.get_size_reduction() }}%</p>
                    </div>
                </div>

                <div class="download-buttons">
                    <a href="{{ url_for('download_file', filename=conversion.converted_filename) }}" class="btn-primary">
üì• –°–∫–∞—á–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    </a>
                </div>
            </div>
            {% endif %}
        </main>
    </div>

    <script>
        // Update quality value display
        const qualitySlider = document.getElementById('quality');
        const qualityValue = document.getElementById('quality-value');

        qualitySlider.addEventListener('input', function() {
            qualityValue.textContent = this.value + '%';
        });
    </script>
</body>
</html>